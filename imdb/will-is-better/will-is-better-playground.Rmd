---
title: 'Will is Better Playground'
author: "Peyton Urquhart [peyton.urquhart]"
output:
  html_document:
    df_print: paged
---

```{r, echo=FALSE}
require("ggplot2")
library(humanVerseWSU);
library(imdb);
```

```{r, echo=FALSE}
github.local = "D:/_git_/peyton.urquhart/";
github.remote = "https://raw.githubusercontent.com/peytonurquhart/WSU_STAT_419/main/";
script = "functions/functions-imdb.R";
```

#### Local or Remote ?

```{r}
which.github = "local";
#which.github = "remote";
```

```{r, echo=FALSE}
if(which.github == "remote")
{
  include.me = paste0( github.remote, script);
  library(devtools)
  library(rstudioapi)
  source_url(include.me);
  
} else if (which.github == "local") {
  
    include.me = paste0( github.local, script);
    source(include.me);
}
```

```{r, chunk-setup, include=FALSE, echo=FALSE}
# include=FALSE means it is running, but invisible ...
knitr::opts_chunk$set(echo = TRUE);
knitr::opts_chunk$set(warning = FALSE);
knitr::opts_chunk$set(message = FALSE);
```

```{r, chunck-loadData, include=TRUE, echo=FALSE}
loadDataIMDB();
```

Enter the number of most relevant movies to analyze:

```{r}
num.movies = 60;
```

## Will Smith (num.movies)

```{r, echo=FALSE}
will.df <- list(movies = IMDB.getMoviesForPerson("nm0000226"), info = IMDB.getPersonInfo("nm0000226"));
will.df$movies <- filterBy(filterOutMissingValues(will.df$movies, 3), 3, (function(x){(x < num.movies + 1)}));
will.df$movies;
will.df$info;
```

## Denzel Washington (num.movies)

```{r, echo=FALSE}
denzel.df <- list(movies = IMDB.getMoviesForPerson("nm0000243"), info = IMDB.getPersonInfo("nm0000243"));
denzel.df$movies <- filterBy(filterOutMissingValues(denzel.df$movies, 3), 3, (function(x){(x < num.movies + 1)}));
denzel.df$movies;
denzel.df$info;
```

# Playground

## Average Audience Rating

The average audience ratings for each actor.

```{r, echo=FALSE}
ndf = plotBarChartAvg(will.df$movies, denzel.df$movies, 9, "Avg. Rating", "Average Audience Rating")
ndf;
```


## Top 10 Movies
#### Will
```{r, echo=FALSE}
will.top10 = filterBy(filterOutMissingValues(will.df$movies, 3), 3, (function(x){(x < 11)}));
will.top10;
```
#### Denzel
```{r, echo=FALSE}
denz.top10 = filterBy(filterOutMissingValues(denzel.df$movies, 3), 3, (function(x){(x < 11)}));
denz.top10;
```


## The Last 15 Years (Since 2006)
#### Will
```{r, echo=FALSE}
will.recent = filterBy(filterOutMissingValues(will.df$movies, 4), 4, (function(x){(x > 2005)}));
will.recent;
```
#### Denzel
```{r, echo=FALSE}
denz.recent = filterBy(filterOutMissingValues(denzel.df$movies, 4), 4, (function(x){(x > 2005)}));
denz.recent;
```


### How many of the top 10 were in the last 15 years?

This will be explained with blockbuster-ability

#### Will
```{r, echo=FALSE}
will.up = filterBy(filterOutMissingValues(will.top10, 4), 4, (function(x){(x > 2005)}));
will.up;
```
#### Denzel
```{r, echo=FALSE}
denz.up = filterBy(filterOutMissingValues(denz.top10, 4), 4, (function(x){(x > 2005)}));
denz.up;
```


## Average number of IMDB votes (Top 10)
```{r, echo=FALSE}
pdf("figures/Avg-Votes.pdf")
ndf = plotBarChartAvg(will.top10, denz.top10, 11, "Avg Num Votes", "Popularity of Top 10 Movies")
ndf;
```

## Total Box Office (All time)

```{r, echo=FALSE}
will.box = filterOutMissingValues(will.df$movies, 12);
denz.box = filterOutMissingValues(denzel.df$movies, 12);

pdf("figures/Total-Box.pdf")
ndf = plotBarChartAvg(will.box, denz.box, 12, "(Millions)", "Total Box Office (All Time)",sum=TRUE)
ndf;
```

## Average Box Office (Top 10)

```{r, echo=FALSE}
will.box = filterOutMissingValues(will.top10, 12);
denz.box = filterOutMissingValues(denz.top10, 12);

pdf("figures/Avg-Box-10.pdf")
ndf = plotBarChartAvg(will.box, denz.box, 12, "(Millions)", "Average Box Office (Top 10 Movies)",sum=FALSE)
ndf;
```

```{r, echo=FALSE}
adf = buildGenresAvgDf(filterOutMissingValues(will.df$movies, 12), 12, sum=FALSE);
bdf = buildGenresAvgDf(filterOutMissingValues(denzel.df$movies, 12), 12, sum=FALSE);

pdf("figures/Will-Box-By-Genre.pdf")
x = plotGenresAvgDf(adf, "Will Smith Avg. Box Office by Genre", "Genre", "(Millions)", ymax=250)
x;

pdf("figures/Denz-Box-By-Genre.pdf")
y = plotGenresAvgDf(bdf, "Denzel Washington Avg. Box Office by Genre", "Genre", "(Millions)", ymax=250)
y;

```

## Blockbuster-ability

```{r, echo=FALSE}
will.box.linear = smoothDataOverTime(will.df$movies, 12, sum=FALSE);
denzel.box.linear = smoothDataOverTime(denzel.df$movies, 12, sum=FALSE);

pdf("figures/Blockbuster-Ability.pdf")
x = plotTimeData(will.box.linear, denzel.box.linear, "Millions USD", "Average Box Office Sales Over Time");
x;


```

## Popularity Over Time

```{r, echo=FALSE}

will.pop.linear = smoothDataOverTime(will.df$movies, 11, sum=TRUE);
denzel.pop.linear = smoothDataOverTime(denzel.df$movies, 11, sum=TRUE);

x = plotTimeData(will.pop.linear, denzel.pop.linear, "Total Votes", "Actor Popularity Over Time");
pdf("figures/Pop-Over-Time.pdf")
x;


```



















