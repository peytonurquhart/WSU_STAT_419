---
title: 'Denzel is Better Playground'
author: "Peyton Urquhart [peyton.urquhart]"
output:
  html_document:
    df_print: paged
---

```{r, echo=FALSE}
suppressWarnings(suppressMessages(require("ggplot2")));
suppressWarnings(suppressMessages(require("quantmod")));
library(humanVerseWSU);
library(imdb);
```

```{r, echo=FALSE}
github.local = "C:/_git_/peyton.urquhart/";
github.remote = "https://raw.githubusercontent.com/peytonurquhart/WSU_STAT_419/master/";
script = "functions/functions-imdb.R";
```

#### Local or Remote ?

```{r}
which.github = "local";
#which.github = "remote";
```

```{r, echo=FALSE}
if(which.github == "remote")
{
  include.me = paste0( github.remote, script);
  library(devtools)
  library(rstudioapi)
  source_url(include.me);
  
} else if (which.github == "local") {
  
    include.me = paste0( github.local, script);
    source(include.me);
}
```

```{r, chunk-setup, include=FALSE, echo=FALSE}
# include=FALSE means it is running, but invisible ...
knitr::opts_chunk$set(echo = TRUE);
knitr::opts_chunk$set(warning = FALSE);
knitr::opts_chunk$set(message = FALSE);
```

```{r, chunck-loadData, include=TRUE, echo=FALSE}
loadDataIMDB();
```

Enter the number of most relevant movies to analyze:

```{r}
num.movies = 60;
```

## Will Smith (num.movies)

```{r, echo=FALSE}
will.df <- list(movies = IMDB.getMoviesForPerson("nm0000226"), info = IMDB.getPersonInfo("nm0000226"));
will.df$movies <- filterBy(filterOutMissingValues(will.df$movies, 3), 3, (function(x){(x < num.movies + 1)}));
will.df$info;
```

```{r, echo=TRUE}
# Adjust to represent '2021 US Dollars'
will.df$movies <- adjustForInflation(will.df$movies, "2021");
will.df$movies;
```

## Denzel Washington (num.movies)

```{r, echo=FALSE}
denzel.df <- list(movies = IMDB.getMoviesForPerson("nm0000243"), info = IMDB.getPersonInfo("nm0000243"));
denzel.df$movies <- filterBy(filterOutMissingValues(denzel.df$movies, 3), 3, (function(x){(x < num.movies + 1)}));
denzel.df$info;
```

```{r, echo=TRUE}
# Adjust to represent '2021 US Dollars'
denzel.df$movies <- adjustForInflation(denzel.df$movies, "2021");
denzel.df$movies;
```


# Playground

## Average Audience Rating

The average audience ratings for each actor.

```{r, echo=FALSE}
ndf = plotBarChartAvg(will.df$movies, denzel.df$movies, 9, "Avg. Rating", "Average Audience Rating")
ndf;
```

## Top 10 Movies
Get the top 10 movies by rank for both actors.
```{r}
will.top10 = filterBy(filterOutMissingValues(will.df$movies, 3), 3, (function(x){(x < 11)}));
denz.top10 = filterBy(filterOutMissingValues(denzel.df$movies, 3), 3, (function(x){(x < 11)}));
```

## The Last 15 Years
Get all movies in the last 15 years for both actors.
```{r, echo}
will.recent = filterBy(filterOutMissingValues(will.df$movies, 4), 4, (function(x){(x > 2005)}));
denz.recent = filterBy(filterOutMissingValues(denzel.df$movies, 4), 4, (function(x){(x > 2005)}));
```

## How Many of the Top 10 were in the Last 15 Years?
Get all movies within the last 15 years which are ranked in the top 10 for both actors.
```{r}
will.up = filterBy(filterOutMissingValues(will.top10, 4), 4, (function(x){(x > 2005)}));
denz.up = filterBy(filterOutMissingValues(denz.top10, 4), 4, (function(x){(x > 2005)}));
```

## Average Audience Ratings By Genre
```{r, echo=FALSE}
adf = buildGenresAvgDf(filterOutMissingValues(will.df$movies, 9), 9, sum=FALSE);
bdf = buildGenresAvgDf(filterOutMissingValues(denzel.df$movies, 9), 9, sum=FALSE);
adf <- removeRow(adf,11);
bdf <- removeRow(bdf,11);
adf <- removeRow(adf,4);
bdf <- removeRow(bdf,4);

x <- plotGenresAvgDf(adf, "Will Smith Avg. Audience Rating By Genre", "Genre", "Rating", ymax=8, ymin=5)
x;
ggsave("figures/will-avg-aud.pdf");

y <- plotGenresAvgDf(bdf, "Denzel Washington Avg. Audience Rating By Genre", "Genre", "Rating", ymax=8, ymin=5)
y;
ggsave("figures/denzel-avg-aud.pdf");
#ggexport(y, filename = "figures/denzel-avg-audience");

# Prepare for pie charts
a.ratings <- cbind(adf, bdf[,3]);
names(a.ratings)[3] <- "will.ratings";
names(a.ratings)[4] <- "denzel.ratings";
a.ratings <- a.ratings[-c(2)];
a.ratings <- prepareBinaryPieChartDf(a.ratings, 2, 3, "will.percent", "denzel.percent");
a.ratings;

```

## Average Critic Ratings By Genre
```{r, echo=FALSE}
adf = buildGenresAvgDf(filterOutMissingValues(will.df$movies, 10), 10, sum=FALSE);
bdf = buildGenresAvgDf(filterOutMissingValues(denzel.df$movies, 10), 10, sum=FALSE);
adf <- removeRow(adf,11);
bdf <- removeRow(bdf,11);
adf <- removeRow(adf,4);
bdf <- removeRow(bdf,4);

plotGenresAvgDf(adf, "Will Smith Avg. Critic Rating By Genre", "Genre", "Rating", ymax=75, ymin=40)

plotGenresAvgDf(bdf, "Denzel Washington Avg. Critic Rating By Genre", "Genre", "Rating", ymax=75, ymin=40)

# Prepare for pie charts
c.ratings <- cbind(adf, bdf[,3]);
names(c.ratings)[3] <- "will.ratings";
names(c.ratings)[4] <- "denzel.ratings";
c.ratings <- c.ratings[-c(2)];
c.ratings <- prepareBinaryPieChartDf(c.ratings, 2, 3, "will.percent", "denzel.percent");
c.ratings;

```

## Final "One Graphic"
#### Will-v-Denzel Average Critic Ratings by Genre
```{r, echo=FALSE}
g = oneGraphicDenzel(c.ratings);
g;
ggexport(g, filename = "figures/1graphic.pdf")
```
















